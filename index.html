<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>SystemJS</title>
	<script src="common/node_modules/lodash/lodash.js"></script>
	<script src="common/node_modules/systemjs/dist/system.js"></script>

	<!--<script src="angular2/node_modules/zone.js/dist/zone.js"></script>-->

	<!--
	<script src="angular4/node_modules/zone.js/dist/zone.js"></script>
	<script src="angular4/node_modules/reflect-metadata/Reflect.js"></script>
	-->

	<script src="angular5/node_modules/zone.js/dist/zone.js"></script>
	<script src="angular5/node_modules/reflect-metadata/Reflect.js"></script>
</head>

<style>
	.appContainer {
		display: block;
	}
</style>
<body>

<ang5_app_one class="appContainer">Loading ang5 app one...</ang5_app_one>

<script>

	var
		runAngular2 = false,
		runAngular4 = false,
		runAngular5 = true;

	var systemJsConfig = {
		packages: {
			ts: {
				main: "lib/plugin.js"
			},
			typescript: {
				main: "lib/typescript.js",
				meta: {
					"lib/typescript.js": {
						exports: "ts"
					}
				}
			}
		},
		map: {
			ts: "common/node_modules/plugin-typescript",
			typescript: "common/node_modules/typescript"
		},
		transpiler: "ts",
		typescriptOptions: {
			declaration: false,
			emitDecoratorMetadata: true,
			experimentalDecorators: true,
			noImplicitAny: true,
			removeComments: false,
			sourceMap: true,
			target: "es5",
			typeRoots: [
				"node_modules/@types"
			]
		}
	};

	if (runAngular2) {
		systemJsConfig.packages = _.extend(systemJsConfig.packages, {
			"@angular/platform-browser-dynamic": {
				main: "bundles/platform-browser-dynamic.umd.js"
			},
			"@angular/platform-browser": {
				main: "bundles/platform-browser.umd.js"
			},
			"@angular/core": {
				main: "bundles/core.umd.js"
			},
			"@angular/common": {
				main: "bundles/common.umd.js"
			},
			"@angular/compiler": {
				main: "bundles/compiler.umd.js"
			},
			rxjs: {
				defaultExtension: "js"
			},
			ang2_app_one: {defaultExtension: "ts"},
			ang2_app_two: {defaultExtension: "ts"}
		});

		systemJsConfig.map = _.extend(systemJsConfig.map, {
			"@angular": "angular2/node_modules/@angular",
			tslib: "angular2/node_modules/tslib",
			rxjs: "angular2/node_modules/rxjs",
			ang2_app_one: "angular2/app_one",
			ang2_app_two: "angular2/app_two"
		});
	}

	if (runAngular4) {
		systemJsConfig.packages = _.extend(systemJsConfig.packages, {
			"@angular/platform-browser-dynamic": {
				main: "bundles/platform-browser-dynamic.umd.js"
			},
			"@angular/platform-browser": {
				main: "bundles/platform-browser.umd.js"
			},
			"@angular/core": {
				main: "bundles/core.umd.js"
			},
			"@angular/common": {
				main: "bundles/common.umd.js"
			},
			"@angular/compiler": {
				main: "bundles/compiler.umd.js"
			},
			tslib: {
				main: "tslib.es6.js"
			},
			rxjs: {
				defaultExtension: "js"
			},
			ang4_app_one: {defaultExtension: "ts"},
			ang4_app_two: {defaultExtension: "ts"}
		});

		systemJsConfig.map = _.extend(systemJsConfig.map, {
			"@angular": "angular4/node_modules/@angular",
			tslib: "angular4/node_modules/tslib",
			rxjs: "angular4/node_modules/rxjs",
			ang4_app_one: "angular4/app_one",
			ang4_app_two: "angular4/app_two"
		});
	}

	if (runAngular5) {
		systemJsConfig.packages = _.extend(systemJsConfig.packages, {
			"@angular/platform-browser-dynamic": {
				main: "bundles/platform-browser-dynamic.umd.js"
			},
			"@angular/platform-browser": {
				main: "bundles/platform-browser.umd.js"
			},
			"@angular/core": {
				main: "bundles/core.umd.js"
			},
			"@angular/common": {
				main: "bundles/common.umd.js"
			},
			"@angular/compiler": {
				main: "bundles/compiler.umd.js"
			},
			"@angular/forms": {
				main: "bundles/forms.umd.js"
			},
			tslib: {
				main: "tslib.es6.js"
			},
			rxjs: {
				defaultExtension: "js"
			},
			ang5_app_one: {defaultExtension: "ts"},
			ang5_app_two: {defaultExtension: "ts"}
		});

		systemJsConfig.map = _.extend(systemJsConfig.map, {
			"@angular": "angular5/node_modules/@angular",
			tslib: "angular5/node_modules/tslib",
			rxjs: "angular5/node_modules/rxjs",
			ang5_app_one: "angular5/app_one",
			ang5_app_two: "angular5/app_two"
		});
	}

	System.config(systemJsConfig);

	if (runAngular2) {
		System.import("ang2_app_one/main").then(null, console.error.bind(console));
	}

	if (runAngular4) {
		System.import("ang4_app_one/main").then(null, console.error.bind(console));
		System.import("ang4_app_two/main").then(null, console.error.bind(console));
	}

	if (runAngular5) {
		System.import("ang5_app_one/main").then(null, console.error.bind(console));
	}

</script>

</body>
</html>